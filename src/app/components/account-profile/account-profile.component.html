<h2>Profile Information</h2>
<div class="profile-card">
  <div class="avatar-placeholder">
    <div class="avatar-initials">{{ username() ? username()![0].toUpperCase() : 'U' }}</div>
  </div>
  
  <div class="profile-info">
    <div class="username-container" *ngIf="!isEditing()">
      <h3>Username</h3>
      <p>{{ username() }}</p>
      <button class="edit-button" (click)="startEditing()">Edit Username</button>
    </div>

    <form [formGroup]="userForm" (ngSubmit)="saveChanges()" *ngIf="isEditing()" class="username-form">
      <h3>Username</h3>
      <div class="form-group">
        <input type="text" formControlName="username" placeholder="Enter new username">
        <div class="validation-error" *ngIf="usernameInvalid">
          <span *ngIf="usernameControl?.errors?.['required']">Username is required</span>
          <span *ngIf="usernameControl?.errors?.['minlength']">Username must be at least 3 characters</span>
          <span *ngIf="usernameControl?.errors?.['maxlength']">Username cannot exceed 20 characters</span>
        </div>
      </div>
      <div class="form-actions">
        <button type="submit" [disabled]="userForm.invalid || isUpdating()">
          <span *ngIf="!isUpdating()">Save Changes</span>
          <span *ngIf="isUpdating()">
            <i class="fas fa-spinner fa-spin"></i> Saving...
          </span>
        </button>
        <button type="button" [disabled]="isUpdating()" (click)="cancelEditing()">Cancel</button>
      </div>
    </form>

    <div class="status-message success" *ngIf="updateSuccess()">
      Username updated successfully!
    </div>
    <div class="status-message error" *ngIf="updateError()">
      Failed to update username. Please try again.
    </div>
  </div>
</div>
